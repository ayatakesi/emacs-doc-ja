@c ===========================================================================
@c
@c This file was generated with po4a. Translate the source file.
@c
@c ===========================================================================

@c This is part of the Emacs manual.
@c Copyright (C) 2004--2024 Free Software Foundation, Inc.
@c See file emacs-ja.texi for copying conditions.
@c
@c This file is included either in emacs-xtra-ja.texi (when producing the
@c printed version) or in the main Emacs manual (for the on-line version).

@node Non-File Buffers
@subsection 非ファイルバッファーの自動リバート

通常Global Auto
Revertモードは、ファイルのバッファーだけをリバートします。非ファイルバッファーにたいして自動リバートを行うには、2つの方法があります。1つはそれらのバッファーにたいしてAuto
Revertモードを有効にする方法です(@kbd{M-x
auto-revert-mode}を使います)。もう1つは@code{global-auto-revert-non-file-buffers}に非@code{nil}値をセットする方法です。後者はそれが実装されているすべての種類のバッファーにたいして、自動リバートを有効にします(以下のメニューにリストされています)。

ファイルバッファーと同様、非ファイルバッファーはそれらにたいして作業を行っているときや、リバートすると失われてしまう情報が含まれているとき、通常はリバートすべきではありません。したがって、それらがmodified(変更されている)のときはリバートしません。非ファイルバッファーが変更されているとマークするのは、ファイルバッファーのときより通常難しいので、トリッキーになり得ます。

他のトリッキーな点に関する詳細は、効率の問題です。自動リバートはしばしばバッファーにたいするすべての可能な変更を検知しようとせず、広範または簡単に検知できる変更だけを検知します。したがって、非ファイルバッファーに自動リバートを有効にすることは、バッファーのすべての情報が最新であると常に保証はしませんし、手動によるリバートを無用にする必要もないからです。

それとは反対に、特定のバッファーは@code{auto-revert-interval}で指定された秒数ごとに自動的にリバートします(これは現在のところBuffer
Menuだけに適用されます)。この場合、自動リバートはリバートの際、@code{auto-revert-verbose}が非@code{nil}でも、何もメッセージを表示しません。

@vindex buffer-auto-revert-by-notification
いくつかの非ファイルバッファーは、バッファーのデフォルトディレクトリーのファイル通知によって信頼性をもって更新が可能です。Diredがその例です。メジャーモードはそのバッファーで@code{buffer-auto-revert-by-notification}に非@code{nil}をセットしてこれを示すことができ、Auto
Revertが定期的なポーリングを行わなくすることができます。このような通知はディレクトリー自身にたいしてだけであり、ディレクトリーのファイルは含まれません。

詳細はバッファーの特性に依存し、それらは対応するセクションで説明されています。

@menu
* Auto Reverting the Buffer Menu::  Buffer 
                                      Menuの自動リバートについて。
* Auto Reverting Dired::     Diredバッファーの自動リバートについて。
@end menu

@node Auto Reverting the Buffer Menu
@subsubsection Buffer Menuの自動リバート

非ファイルバッファーの自動リバートが有効なとき、必要性の有無にかかわらず、Buffer Menu
@iftex
(@ref{Several Buffers,,, emacs, the Emacs Manual}を参照)
@end iftex
@ifnottex
(@ref{Several Buffers}を参照)
@end ifnottex
は@code{auto-revert-interval}で指定された秒数ごとに自動的にリバートされます。(リバートする必要があるかチェックするのは、恐らく実際にリバートするより長い時間を要する)。

Buffer
Menuがmodifiedと不適切にマークされたときは、@kbd{g}により手動でリバートして自動リバートを再開します。しかし特定のバッファーにたいして削除や表示のマークをつけた場合は、慎重になる必要があります。なぜならリバートはすべてのマークを消去するからです。マークの追加はバッファーのmodifiedフラグをセットするという事実は、自動的なマークの消去からの自動リバートを防ぎます。

@node Auto Reverting Dired
@subsubsection Diredバッファーの自動リバート

Diredバッファーは、バッファーのメインディレクトリーのファイルリストが変化したとき(たとえば新しいファイルの追加や削除)だけ、自動リバートします。特定のファイルの情報が変化したとき(たとえばサイズの変化)や、サブディレクトリーへの追加は自動リバートしません。@emph{すべて}のリストされた情報が最新であることを確実にするには、Diredバッファーで自動リバートが@emph{有効であっても}、手動で@kbd{g}を使ってリバートする必要があります。メインディレクトリーにリストされているファイルへの変更や保存で、実際に自動リバートが起こるのに気付くかもしれません。これはファイルの変更や保存は、たとえばバックアップファイルやauto-saveファイルにより、高い確率でディレクトリー自身を変更するからです。しかし、これは保証されているわけではありません。

Diredバッファーがmodifiedとマークされ、残したい変更がない場合、大抵は@kbd{g}でバッファーを手動でリバートすることにより、自動リバートを再開できます。しかし1つ例外があります。ファイルにフラグやマークをつけた場合、安全にバッファーをリバートできます。これはフラグやマークを消去しません(もちろんマークされたファイルが削除されていない場合です)。しかしバッファーはリバートの後でさえmodifiedの状態に留まるので、自動リバートは再開しません。これは、もしファイルにたいしてフラグやマークをつけた場合、それはバッファーにたいして作業をしており、警告なしにバッファーが変更されることを望まないだろうからです。マークやフラグがある状態で自動リバートを再開したいときは、@kbd{M-~}を使ってバッファーをnon-modifiedとマークします。しかしマークやフラグの追加・削除・変更により、バッファーは再びmodifiedとマークされます。

現在のところ、リモートのDiredバッファーは、自動リバートされません。特定のファイルだけをリストするように、シェルのワイルドカードやファイル引数を与えられたDiredバッファーも同じです。@file{*Find*}および@file{*Locate*}は、どちらも自動リバートしません。

Diredバッファーの自動リバートは、いくつかのシステムでは満足に機能しないかもしれないことに注意してください。
